# WaitFree (ì›¨ì´íŠ¸í”„ë¦¬) â€” PRD

## í”„ë¡œì íŠ¸ ê°œìš”

- **í•œ ì¤„ ìš”ì•½:** ê³µê³µê¸°ê´€ ì„œë²„ í­ì£¼ / ì „í™” ëŒ€ê¸° ìƒí™©ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” ì›¹ ì„œë¹„ìŠ¤
- **ë¬¸ì œ ì •ì˜:** ì •ë¶€24, ê±´ê°•ë³´í—˜ê³µë‹¨ ê°™ì€ ê³µê³µê¸°ê´€ì´ í„°ì¡Œì„ ë•Œ "ë‚˜ë§Œ ì•ˆ ë˜ë‚˜?" í™•ì¸í•  ë°©ë²•ì´ ì—†ìŒ. ì „í™” ëŒ€ê¸°ëŠ” ëª‡ ëª…ì¸ì§€ë„ ëª¨ë¥´ê³  ê¸°ë‹¤ë¦¼.
- **í•´ê²° ë°©ë²•:** ì‚¬ìš©ìžë“¤ì´ "ì•ˆ ë¼ìš”/ìž˜ ë¼ìš”"ë¥¼ ì œë³´í•˜ê³ , ì›¹ì‚¬ì´íŠ¸ëŠ” ìžë™ pingë„ í•´ì„œ ì‹ í˜¸ë“±ìœ¼ë¡œ í•œëˆˆì— ë³´ì—¬ì¤Œ
- **ëŒ€ìƒ ì‚¬ìš©ìž:** ê³µê³µê¸°ê´€ ì›¹ì‚¬ì´íŠ¸/ì „í™”ë¥¼ ì´ìš©í•˜ëŠ” ì¼ë°˜ êµ­ë¯¼ (ì£¼ë¡œ ëª¨ë°”ì¼)

---

## ê¸°ìˆ  ìŠ¤íƒ ìƒì„¸

| ê¸°ìˆ  | ì„ íƒ ì´ìœ  |
|------|-----------|
| Next.js 16 (App Router) | SSR + API Routes + ì„œë²„ ì»´í¬ë„ŒíŠ¸ë¡œ í”„ë¡ íŠ¸Â·ë°±ì—”ë“œ í†µí•©. Vercelê³¼ ê¶í•© ìµœê³  |
| Supabase | PostgreSQL + Realtime + Row Level Security ë¬´ë£Œ ì œê³µ. Firebaseë³´ë‹¤ SQL ê¸°ë°˜ì´ë¼ ì§‘ê³„ ì¿¼ë¦¬ ìœ ë¦¬ |
| Tailwind CSS | ìœ í‹¸ë¦¬í‹° í´ëž˜ìŠ¤ë¡œ ë¹ ë¥¸ UI ê°œë°œ. ëª¨ë°”ì¼ ë°˜ì‘í˜• ì‰¬ì›€ |
| TypeScript | íƒ€ìž… ì•ˆì „ì„±. API ìš”ì²­/ì‘ë‹µ íƒ€ìž… ëª…í™•ížˆ ì •ì˜ |
| Vercel | Next.js ê³µì‹ ë°°í¬ í”Œëž«í¼. ë¬´ë£Œ í”Œëžœìœ¼ë¡œ MVP ì¶©ë¶„ |
| @fingerprintjs/fingerprintjs | ì˜¤í”ˆì†ŒìŠ¤ ë¸Œë¼ìš°ì € í•‘ê±°í”„ë¦°íŠ¸. ë¡œê·¸ì¸ ì—†ì´ ê°™ì€ ì‚¬ëžŒ êµ¬ë¶„ |

---

## ê¸°ëŠ¥ ëª©ë¡ + ìƒì„¸ ì„¤ëª…

### ê¸°ëŠ¥ 1: ë©”ì¸ íŽ˜ì´ì§€ (/)

**ë ˆì´ì•„ì›ƒ:**
- ìƒë‹¨ í—¤ë”: "WaitFree" ë¡œê³  + "ê³µê³µê¸°ê´€ ì§€ê¸ˆ í„°ì¡Œë‚˜ìš”?" ì„œë¸Œí…ìŠ¤íŠ¸
- ì¤‘ê°„: Preset ê¸°ê´€ íƒ­ ì˜ì—­ (ì •ë¶€24 / êµ­ë¯¼ê±´ê°•ë³´í—˜ê³µë‹¨)
- íƒ­ ë‚´ë¶€: í•´ë‹¹ ê¸°ê´€ì˜ ìƒíƒœ ì¹´ë“œ (ê¸°ëŠ¥ 2 ì°¸ê³ )
- íƒ­ ì•„ëž˜: ì‚¬ìš©ìž ë“±ë¡ ê¸°ê´€ ë¦¬ìŠ¤íŠ¸ (ì¹´ë“œ í˜•íƒœ, ìµœì‹ ìˆœ)
- í•˜ë‹¨: "+ ë‹¤ë¥¸ ê¸°ê´€ ì¶”ê°€í•˜ê¸°" ë²„íŠ¼ â†’ /add íŽ˜ì´ì§€ë¡œ ì´ë™

**íƒ­ ë™ìž‘:**
- ê¸°ë³¸ ì„ íƒ: ì²« ë²ˆì§¸ íƒ­ (ì •ë¶€24)
- íƒ­ ì „í™˜ ì‹œ í•´ë‹¹ ê¸°ê´€ ìƒíƒœ ì¹´ë“œë¡œ êµì²´
- URL ë³€ê²½ ì—†ìŒ (í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ì „í™˜)

**ì‚¬ìš©ìž ë“±ë¡ ê¸°ê´€ ë¦¬ìŠ¤íŠ¸:**
- Presetì´ ì•„ë‹Œ ê¸°ê´€ë“¤ì„ ìµœì‹  ë“±ë¡ìˆœìœ¼ë¡œ í‘œì‹œ
- ê° í•­ëª©: ê¸°ê´€ ì´ë¦„ + ì‹ í˜¸ë“± ì•„ì´ì½˜ (ì†Œí˜•) + ì¢…ë¥˜ ë±ƒì§€ (ì›¹/ì „í™”)
- í´ë¦­ ì‹œ í•´ë‹¹ ê¸°ê´€ì˜ ìƒíƒœ ì¹´ë“œê°€ íŽ¼ì³ì§ (ì•„ì½”ë””ì–¸ ë°©ì‹)
- ê¸°ê´€ì´ ì—†ìœ¼ë©´: "ì•„ì§ ë“±ë¡ëœ ê¸°ê´€ì´ ì—†ì–´ìš”. ì²« ë²ˆì§¸ë¡œ ì¶”ê°€í•´ë³´ì„¸ìš”!" ë¹ˆ ìƒíƒœ ë©”ì‹œì§€

**ë¹ˆ ìƒíƒœ ì²˜ë¦¬:**
- ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì‹œ: "ì—°ê²°ì´ ë¶ˆì•ˆì •í•´ìš”. ìž ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”" + ìž¬ì‹œë„ ë²„íŠ¼
- ë¡œë”© ì¤‘: ì‹ í˜¸ë“± ëª¨ì–‘ ìŠ¤ì¼ˆë ˆí†¤ UI

---

### ê¸°ëŠ¥ 2: ê¸°ê´€ ìƒíƒœ ì¹´ë“œ

**êµ¬ì„± ìš”ì†Œ:**
- ê¸°ê´€ ì´ë¦„ + ì¢…ë¥˜ ë±ƒì§€ (ì›¹ì‚¬ì´íŠ¸ ðŸŒ / ì „í™” ðŸ“ž)
- ì‹ í˜¸ë“± (í¬ê²Œ, í™”ë©´ ì¤‘ì•™)
  - ì´ˆë¡ ðŸŸ¢: "ì¾Œì í•´ìš”" (ì •ìƒ)
  - ë…¸ëž‘ ðŸŸ¡: "ì¢€ ëŠë ¤ìš”" (ì£¼ì˜)
  - ë¹¨ê°• ðŸ”´: "í„°ì¡Œì–´ìš”!" (í­ì£¼)
  - íšŒìƒ‰ âšª: "ì •ë³´ ì—†ìŒ" (ì œë³´ 0ê±´ + ping ì—†ìŒ)
- ì œë³´ ìš”ì•½ í…ìŠ¤íŠ¸: "ì§€ê¸ˆ OOëª…ì´ ì•ˆ ëœë‹¤ê³  í–ˆì–´ìš”" (ìµœê·¼ 10ë¶„)
- ì œë³´ ë²„íŠ¼ 2ê°œ: [ðŸ‘ ìž˜ ë¼ìš”] [ðŸ˜¡ ì•ˆ ë¼ìš”!]
- ì „í™” ê¸°ê´€ ì „ìš©: "ëŒ€ê¸° ëª‡ ëª…ì´ì—ˆì–´ìš”?" ìˆ«ìž ìž…ë ¥ (0~999, ì •ìˆ˜ë§Œ)
- ìµœê·¼ ì œë³´ íƒ€ìž„ë¼ì¸: ìµœì‹  5ê°œ ("3ë¶„ ì „ - ì•ˆ ë¼ìš”", "5ë¶„ ì „ - ìž˜ ë¼ìš”")

**ì›¹ì‚¬ì´íŠ¸ ê¸°ê´€ ì „ìš© ì¶”ê°€ í‘œì‹œ:**
- ë§ˆì§€ë§‰ ìžë™ ì²´í¬ ì‹œê°„: "2ë¶„ ì „ ìžë™ í™•ì¸: ì‘ë‹µ 0.8ì´ˆ"
- pingê³¼ ì œë³´ê°€ ë‹¤ë¥¼ ë•Œ: "í•‘ì€ ì •ìƒì¸ë° 3ëª…ì´ ì•ˆ ëœë‹¤ê³  í–ˆì–´ìš”" ë³´ì¡° ë©”ì‹œì§€

**ì‚¬ìš©ìž íë¦„ (ì œë³´í•˜ê¸°):**
1. ìƒíƒœ ì¹´ë“œì—ì„œ [ðŸ˜¡ ì•ˆ ë¼ìš”!] ë˜ëŠ” [ðŸ‘ ìž˜ ë¼ìš”] ë²„íŠ¼ í´ë¦­
2. ì „í™” ê¸°ê´€ì´ë©´ â†’ ì„ íƒì ìœ¼ë¡œ ëŒ€ê¸° ì¸ì› ìˆ«ìž ìž…ë ¥
3. ì œë³´ ì ‘ìˆ˜ â†’ ë²„íŠ¼ ë¹„í™œì„±í™” + "ì œë³´ ì™„ë£Œ!" í† ìŠ¤íŠ¸
4. 5ë¶„ í›„ ë‹¤ì‹œ ì œë³´ ê°€ëŠ¥ (íƒ€ì´ë¨¸ í‘œì‹œ: "4ë¶„ 32ì´ˆ í›„ ë‹¤ì‹œ ì œë³´í•  ìˆ˜ ìžˆì–´ìš”")
5. Realtimeìœ¼ë¡œ ë‹¤ë¥¸ ì‚¬ëžŒ ì œë³´ë„ ì¦‰ì‹œ ë°˜ì˜

**ìž…ë ¥ ê²€ì¦ ê·œì¹™:**
- ëŒ€ê¸° ì¸ì›: 0 ì´ìƒ 999 ì´í•˜ ì •ìˆ˜ë§Œ. ì†Œìˆ˜ì /ìŒìˆ˜/ë¬¸ìž â†’ ë¬´ì‹œ
- 5ë¶„ ë‚´ ê°™ì€ ê¸°ê´€ ì¤‘ë³µ ì œë³´ â†’ "ì¡°ê¸ˆ ì „ì— ì œë³´í–ˆì–´ìš”. Në¶„ í›„ì— ë‹¤ì‹œ í•´ì£¼ì„¸ìš”" í† ìŠ¤íŠ¸

---

### ê¸°ëŠ¥ 3: ê¸°ê´€ ë“±ë¡ íŽ˜ì´ì§€ (/add)

**ë ˆì´ì•„ì›ƒ:**
- ìƒë‹¨: â† ë’¤ë¡œê°€ê¸° + "ìƒˆ ê¸°ê´€ ë“±ë¡"
- í¼:
  - ê¸°ê´€ ì´ë¦„ (í…ìŠ¤íŠ¸, í•„ìˆ˜, 2~50ìž)
  - ì¢…ë¥˜ ì„ íƒ: [ì›¹ì‚¬ì´íŠ¸] / [ì „í™”] í† ê¸€ ë²„íŠ¼
  - ì›¹ì‚¬ì´íŠ¸ ì„ íƒ ì‹œ â†’ URL ìž…ë ¥ (https:// í¬í•¨, í•„ìˆ˜)
  - ì „í™” ì„ íƒ ì‹œ â†’ ì „í™”ë²ˆí˜¸ ìž…ë ¥ (ìˆ«ìž+í•˜ì´í”ˆ, í•„ìˆ˜)
- í•˜ë‹¨: [ë“±ë¡í•˜ê¸°] ë²„íŠ¼

**ì‚¬ìš©ìž íë¦„:**
1. ê¸°ê´€ ì´ë¦„ ìž…ë ¥
2. ì¢…ë¥˜ ì„ íƒ (ì›¹ì‚¬ì´íŠ¸/ì „í™”)
3. URL ë˜ëŠ” ì „í™”ë²ˆí˜¸ ìž…ë ¥
4. [ë“±ë¡í•˜ê¸°] í´ë¦­
5. ì¤‘ë³µ ì²´í¬ í†µê³¼ â†’ "ë“±ë¡ ì™„ë£Œ!" + ë©”ì¸ìœ¼ë¡œ ì´ë™
6. ì¤‘ë³µì´ë©´ â†’ "ì´ë¯¸ ë“±ë¡ëœ ê³³ì´ì—ìš”!" ì•Œë¦¼ + í•´ë‹¹ ê¸°ê´€ìœ¼ë¡œ ì´ë™ ë§í¬

**ìž…ë ¥ ê²€ì¦ ê·œì¹™:**
- ê¸°ê´€ ì´ë¦„: 2ìž ì´ìƒ 50ìž ì´í•˜. ê³µë°±ë§Œì€ ë¶ˆê°€
- URL: https:// ë˜ëŠ” http://ë¡œ ì‹œìž‘. ìœ íš¨í•œ URL í˜•ì‹
- ì „í™”ë²ˆí˜¸: ìˆ«ìžì™€ í•˜ì´í”ˆë§Œ í—ˆìš©. ìµœì†Œ 8ìž
- ê°™ì€ fingerprintë¡œ í•˜ë£¨(24ì‹œê°„) 3ê°œê¹Œì§€ë§Œ ë“±ë¡ ê°€ëŠ¥. ì´ˆê³¼ ì‹œ "ì˜¤ëŠ˜ì€ ë” ë“±ë¡í•  ìˆ˜ ì—†ì–´ìš”"

**ì¤‘ë³µ ì²´í¬:**
- URL: í”„ë¡œí† ì½œ ì œê±° í›„ ë¹„êµ (www.gov.kr === gov.kr)
- ì „í™”ë²ˆí˜¸: í•˜ì´í”ˆ ì œê±° í›„ ë¹„êµ (1577-1000 === 15771000)

---

### ê¸°ëŠ¥ 4: ìžë™ Ping (On-Demand ë°©ì‹)

**ì™œ On-Demandì¸ê°€:**
Vercel ë¬´ë£Œ í”Œëžœì€ Cronì´ í•˜ë£¨ 1íšŒë§Œ ê°€ëŠ¥. ê·¸ëž˜ì„œ Cron ëŒ€ì‹  "ì‚¬ìš©ìžê°€ íŽ˜ì´ì§€ë¥¼ ë³¼ ë•Œ" ì„œë²„ì—ì„œ pingí•˜ëŠ” ë°©ì‹ ì±„íƒ.

**ë™ìž‘ ë°©ì‹:**
1. ì‚¬ìš©ìžê°€ ê¸°ê´€ ìƒíƒœë¥¼ ì¡°íšŒí•  ë•Œ (GET /api/status/[orgId])
2. í•´ë‹¹ ê¸°ê´€ì´ website íƒ€ìž…ì´ë©´ â†’ ë§ˆì§€ë§‰ ping ì‹œê°„ í™•ì¸
3. ë§ˆì§€ë§‰ pingì´ 5ë¶„ ì´ìƒ ì§€ë‚¬ìœ¼ë©´ â†’ ë°±ê·¸ë¼ìš´ë“œë¡œ ping ì‹¤í–‰ + ê²°ê³¼ ì €ìž¥
4. 5ë¶„ ì´ë‚´ë©´ â†’ ê¸°ì¡´ ping ê²°ê³¼ ì‚¬ìš©

**ping ì‹¤í–‰:**
- í•´ë‹¹ URLë¡œ GET ìš”ì²­ (íƒ€ìž„ì•„ì›ƒ 10ì´ˆ)
- ì‘ë‹µ ì‹œê°„ ì¸¡ì •:
  - 1ì´ˆ(1000ms) ì´ë‚´ â†’ ì •ìƒ
  - 1~5ì´ˆ(1000~5000ms) â†’ ëŠë¦¼
  - 5ì´ˆ ì´ˆê³¼ or ì—ëŸ¬ â†’ í­ì£¼
- ë‹¨, 1íšŒ ì‹¤íŒ¨ë§Œìœ¼ë¡œ ë¹¨ê°• ì•ˆ í•¨ â†’ ì§ì „ pingë„ ì‹¤íŒ¨ì˜€ìœ¼ë©´ ê·¸ë•Œ ë¹¨ê°•
  - ì§ì „ ping ì—†ê±°ë‚˜ ì„±ê³µì´ì—ˆìœ¼ë©´ â†’ ë…¸ëž‘ìœ¼ë¡œ í‘œì‹œ + "í™•ì¸ ì¤‘" ë©”ì‹œì§€

**ì •ë¶€ ì‚¬ì´íŠ¸ ì°¨ë‹¨ ëŒ€ë¹„:**
- User-Agentë¥¼ ì¼ë°˜ ë¸Œë¼ìš°ì €ì²˜ëŸ¼ ì„¤ì •
- ping ê°„ê²© ìµœì†Œ 5ë¶„ ìœ ì§€ (ê³¼ë„í•œ ìš”ì²­ ë°©ì§€)
- ì—°ì† 5íšŒ ì´ìƒ ì°¨ë‹¨(403/blocked) â†’ í•´ë‹¹ ê¸°ê´€ ping ìžë™ ì¤‘ë‹¨, ì œë³´ë§Œìœ¼ë¡œ ì „í™˜

---

### ê¸°ëŠ¥ 5: ì‹ í˜¸ë“± íŒì • ë¡œì§

#### ì›¹ì‚¬ì´íŠ¸ ê¸°ê´€ (ping + ì œë³´ ì¢…í•©)

**1ì°¨ ê¸°ì¤€: ìµœì‹  ping ê²°ê³¼**

| ping ì‘ë‹µ | ì‹ í˜¸ë“± |
|-----------|--------|
| 1000ms ì´ë‚´ | ðŸŸ¢ ì´ˆë¡ |
| 1000~5000ms | ðŸŸ¡ ë…¸ëž‘ |
| 5000ms ì´ˆê³¼ or ì—ëŸ¬ | ðŸ”´ ë¹¨ê°• (ì—°ì† 2íšŒ ì‹œ) / ðŸŸ¡ ë…¸ëž‘ (1íšŒë§Œ) |
| ping ì—†ìŒ (ì‹ ê·œ ê¸°ê´€) | âšª íšŒìƒ‰ |

**2ì°¨ ë³´ì¡°: ìµœê·¼ 10ë¶„ ì œë³´**
- pingì´ ì´ˆë¡ì¸ë° "ì•ˆ ë¼ìš”" ì œë³´ê°€ 3ê±´ ì´ìƒ â†’ ë³´ì¡° ë©”ì‹œì§€: "í•‘ì€ ì •ìƒì¸ë° Nëª…ì´ ì•ˆ ëœë‹¤ê³  í–ˆì–´ìš”"
- pingì´ ë¹¨ê°•ì¸ë° "ìž˜ ë¼ìš”" ì œë³´ê°€ 3ê±´ ì´ìƒ â†’ ë³´ì¡° ë©”ì‹œì§€: "ì„œë²„ëŠ” ëŠë¦°ë° Nëª…ì€ ê´œì°®ë‹¤ê³  í–ˆì–´ìš”"
- ì‹ í˜¸ë“± ìƒ‰ìƒ ìžì²´ëŠ” ping ê¸°ì¤€ ìœ ì§€ (ì œë³´ê°€ ì‹ í˜¸ë“±ì„ ë°”ê¾¸ì§€ëŠ” ì•ŠìŒ)

#### ì „í™” ê¸°ê´€ (100% ì œë³´ ê¸°ë°˜)

| ìµœê·¼ 10ë¶„ "ì•ˆ ë¼ìš”" ë¹„ìœ¨ | ì‹ í˜¸ë“± |
|--------------------------|--------|
| 70% ì´ìƒ | ðŸ”´ ë¹¨ê°• |
| 30~70% | ðŸŸ¡ ë…¸ëž‘ |
| 30% ë¯¸ë§Œ | ðŸŸ¢ ì´ˆë¡ |
| ì œë³´ 0ê±´ | âšª íšŒìƒ‰ |

- ëŒ€ê¸° ì¸ì› ìˆ«ìž ì œë³´ê°€ ìžˆìœ¼ë©´ â†’ í‰ê· ê°’ í‘œì‹œ: "í‰ê·  ëŒ€ê¸° ì•½ OOëª…"
- ìµœì†Œ ì œë³´ 2ê±´ ì´ìƒì´ì–´ì•¼ ì‹ í˜¸ë“± í™œì„±í™” (1ê±´ë§Œìœ¼ë¡œ íŒë‹¨ ì•ˆ í•¨)

---

## Supabase DB ìŠ¤í‚¤ë§ˆ

### organizations (ê¸°ê´€ ëª©ë¡)

| ì»¬ëŸ¼ | íƒ€ìž… | ì œì•½ì¡°ê±´ | ì„¤ëª… |
|------|------|----------|------|
| id | uuid | PK, default gen_random_uuid() | ìžë™ ìƒì„± |
| name | text | NOT NULL | ê¸°ê´€ ì´ë¦„ |
| type | text | NOT NULL, CHECK (type IN ('website', 'phone')) | ì¢…ë¥˜ |
| url | text | NULLABLE, UNIQUE (ì¤‘ë³µ ë°©ì§€) | ì›¹ì‚¬ì´íŠ¸ ì£¼ì†Œ (ì •ê·œí™” ì €ìž¥) |
| phone | text | NULLABLE, UNIQUE (ì¤‘ë³µ ë°©ì§€) | ì „í™”ë²ˆí˜¸ (í•˜ì´í”ˆ ì œê±° ì €ìž¥) |
| is_preset | boolean | NOT NULL, DEFAULT false | ë¯¸ë¦¬ ê¹”ì•„ë‘” ê¸°ê´€ ì—¬ë¶€ |
| ping_enabled | boolean | NOT NULL, DEFAULT true | ping í™œì„±í™” ì—¬ë¶€ (ì°¨ë‹¨ ê°ì§€ ì‹œ false) |
| created_at | timestamptz | NOT NULL, DEFAULT now() | ë“±ë¡ ì‹œê°„ |

**ì¸ë±ìŠ¤:**
- idx_organizations_type ON organizations(type)
- idx_organizations_is_preset ON organizations(is_preset) WHERE is_preset = true
- unique_url ON organizations(url) WHERE url IS NOT NULL
- unique_phone ON organizations(phone) WHERE phone IS NOT NULL

**CHECK ì œì•½:**
- (type = 'website' AND url IS NOT NULL) OR (type = 'phone' AND phone IS NOT NULL)

---

### reports (ì‚¬ìš©ìž ì œë³´)

| ì»¬ëŸ¼ | íƒ€ìž… | ì œì•½ì¡°ê±´ | ì„¤ëª… |
|------|------|----------|------|
| id | uuid | PK, default gen_random_uuid() | ìžë™ ìƒì„± |
| org_id | uuid | FK â†’ organizations(id) ON DELETE CASCADE, NOT NULL | ê¸°ê´€ ì°¸ì¡° |
| status | text | NOT NULL, CHECK (status IN ('good', 'bad')) | ì œë³´ ìƒíƒœ |
| wait_count | integer | NULLABLE, CHECK (wait_count >= 0 AND wait_count <= 999) | ì „í™” ëŒ€ê¸° ì¸ì› |
| fingerprint | text | NOT NULL | IP + ë¸Œë¼ìš°ì € ì¡°í•© SHA-256 í•´ì‹œ |
| created_at | timestamptz | NOT NULL, DEFAULT now() | ì œë³´ ì‹œê°„ |

**ì¸ë±ìŠ¤:**
- idx_reports_org_created ON reports(org_id, created_at DESC) â€” ê¸°ê´€ë³„ ìµœê·¼ ì œë³´ ì¡°íšŒìš©
- idx_reports_fingerprint_created ON reports(fingerprint, created_at DESC) â€” ì¤‘ë³µ ì œë³´ ì²´í¬ìš©
- idx_reports_created ON reports(created_at) â€” ì˜¤ëž˜ëœ ë°ì´í„° ì‚­ì œìš©

---

### ping_results (ìžë™ í•‘ ê²°ê³¼)

| ì»¬ëŸ¼ | íƒ€ìž… | ì œì•½ì¡°ê±´ | ì„¤ëª… |
|------|------|----------|------|
| id | uuid | PK, default gen_random_uuid() | ìžë™ ìƒì„± |
| org_id | uuid | FK â†’ organizations(id) ON DELETE CASCADE, NOT NULL | ê¸°ê´€ ì°¸ì¡° |
| response_time_ms | integer | NOT NULL | ì‘ë‹µ ì‹œê°„ (ë°€ë¦¬ì´ˆ) |
| status_code | integer | NULLABLE | HTTP ìƒíƒœ ì½”ë“œ |
| is_error | boolean | NOT NULL, DEFAULT false | ì—ëŸ¬ ì—¬ë¶€ |
| created_at | timestamptz | NOT NULL, DEFAULT now() | í•‘ ì‹œê°„ |

**ì¸ë±ìŠ¤:**
- idx_ping_org_created ON ping_results(org_id, created_at DESC) â€” ê¸°ê´€ë³„ ìµœê·¼ í•‘ ì¡°íšŒìš©
- idx_ping_created ON ping_results(created_at) â€” ì˜¤ëž˜ëœ ë°ì´í„° ì‚­ì œìš©

---

## API ì„¤ê³„

### POST /api/report â€” ì œë³´ ì ‘ìˆ˜

**Request Body:**
```json
{
  "orgId": "uuid",
  "status": "good" | "bad",
  "waitCount": 15,          // ì„ íƒ, ì „í™” ê¸°ê´€ë§Œ
  "fingerprint": "sha256hash"
}
```

**ì²˜ë¦¬ ë¡œì§:**
1. orgId ìœ íš¨ì„± ê²€ì‚¬ (í•´ë‹¹ ê¸°ê´€ ì¡´ìž¬í•˜ëŠ”ì§€)
2. fingerprint + orgIdë¡œ 5ë¶„ ë‚´ ì¤‘ë³µ ì²´í¬
3. waitCountê°€ ìžˆìœ¼ë©´ 0~999 ë²”ìœ„ ê²€ì¦
4. reports í…Œì´ë¸”ì— INSERT
5. ì„±ê³µ ì‘ë‹µ

**Response 200:**
```json
{
  "success": true,
  "reportId": "uuid"
}
```

**ì—ëŸ¬ ì½”ë“œ:**
| ì½”ë“œ | ìƒí™© |
|------|------|
| 400 | í•„ìˆ˜ í•„ë“œ ëˆ„ë½, ìœ íš¨í•˜ì§€ ì•Šì€ status ê°’, waitCount ë²”ìœ„ ì´ˆê³¼ |
| 404 | ì¡´ìž¬í•˜ì§€ ì•ŠëŠ” orgId |
| 429 | 5ë¶„ ë‚´ ì¤‘ë³µ ì œë³´ (retryAfterSeconds í¬í•¨) |
| 500 | DB ì˜¤ë¥˜ |

---

### GET /api/status/[orgId] â€” ê¸°ê´€ ìƒíƒœ ì¡°íšŒ

**ì²˜ë¦¬ ë¡œì§:**
1. orgIdë¡œ ê¸°ê´€ ì •ë³´ ì¡°íšŒ
2. ê¸°ê´€ typeì´ "website"ì´ê³  ping_enabledê°€ trueì´ë©´:
   - ìµœì‹  pingì˜ created_at í™•ì¸
   - 5ë¶„ ì´ìƒ ê²½ê³¼ â†’ ë°±ê·¸ë¼ìš´ë“œ ping ì‹¤í–‰ (ì‘ë‹µì€ ê¸°ì¡´ ë°ì´í„°ë¡œ ë¨¼ì € ë°˜í™˜)
3. ìµœê·¼ 10ë¶„ ì œë³´ ì§‘ê³„ (good ìˆ˜, bad ìˆ˜, ì´ ìˆ˜)
4. ìµœê·¼ 10ë¶„ wait_count í‰ê·  (ì „í™” ê¸°ê´€)
5. ìµœê·¼ 5ê°œ ì œë³´ íƒ€ìž„ë¼ì¸
6. ì‹ í˜¸ë“± íŒì • â†’ ì‘ë‹µ

**Response 200:**
```json
{
  "orgId": "uuid",
  "orgName": "ì •ë¶€24",
  "orgType": "website",
  "signal": "green",
  "summary": {
    "totalReports": 12,
    "goodCount": 8,
    "badCount": 4,
    "avgWaitCount": null
  },
  "ping": {
    "lastCheckedAt": "2025-01-15T10:30:00Z",
    "responseTimeMs": 800,
    "isError": false
  },
  "auxiliaryMessage": null,
  "timeline": [
    { "status": "bad", "createdAt": "2025-01-15T10:32:00Z" },
    { "status": "good", "createdAt": "2025-01-15T10:30:00Z" }
  ]
}
```

**ì—ëŸ¬ ì½”ë“œ:**
| ì½”ë“œ | ìƒí™© |
|------|------|
| 404 | ì¡´ìž¬í•˜ì§€ ì•ŠëŠ” orgId |
| 500 | DB ì˜¤ë¥˜ |

---

### POST /api/organization â€” ê¸°ê´€ ë“±ë¡

**Request Body:**
```json
{
  "name": "êµ­ì„¸ì²­",
  "type": "website",
  "url": "https://www.nts.go.kr",
  "phone": null,
  "fingerprint": "sha256hash"
}
```

**ì²˜ë¦¬ ë¡œì§:**
1. í•„ìˆ˜ í•„ë“œ ê²€ì¦
2. name ê¸¸ì´ ê²€ì¦ (2~50ìž)
3. typeì— ë”°ë¼ url ë˜ëŠ” phone í•„ìˆ˜ ê²€ì¦
4. URL ì •ê·œí™”: í”„ë¡œí† ì½œ ì œê±°, trailing slash ì œê±°, ì†Œë¬¸ìží™” í›„ ì €ìž¥
5. ì „í™”ë²ˆí˜¸ ì •ê·œí™”: í•˜ì´í”ˆ ì œê±° í›„ ì €ìž¥
6. ì¤‘ë³µ ì²´í¬ (ì •ê·œí™”ëœ ê°’ìœ¼ë¡œ ë¹„êµ)
7. fingerprintë¡œ 24ì‹œê°„ ë‚´ ë“±ë¡ íšŸìˆ˜ ì²´í¬ (3ê°œ ì œí•œ)
8. INSERT + ì„±ê³µ ì‘ë‹µ

**Response 201:**
```json
{
  "success": true,
  "organization": { "id": "uuid", "name": "êµ­ì„¸ì²­" }
}
```

**ì—ëŸ¬ ì½”ë“œ:**
| ì½”ë“œ | ìƒí™© |
|------|------|
| 400 | í•„ìˆ˜ í•„ë“œ ëˆ„ë½, ì´ë¦„ ê¸¸ì´ ì´ˆê³¼, URL/ì „í™”ë²ˆí˜¸ í˜•ì‹ ì˜¤ë¥˜ |
| 409 | ì´ë¯¸ ë“±ë¡ëœ URL ë˜ëŠ” ì „í™”ë²ˆí˜¸ (existingOrgId í¬í•¨) |
| 429 | 24ì‹œê°„ ë‚´ 3ê°œ ì´ˆê³¼ ë“±ë¡ ì‹œë„ |
| 500 | DB ì˜¤ë¥˜ |

---

### POST /api/ping/[orgId] â€” ìˆ˜ë™ Ping (ë‚´ë¶€ í˜¸ì¶œìš©)

**ì²˜ë¦¬ ë¡œì§:**
1. orgIdë¡œ ê¸°ê´€ ì¡°íšŒ (website íƒ€ìž…ë§Œ í—ˆìš©)
2. ping_enabled í™•ì¸ (falseë©´ ìŠ¤í‚µ)
3. í•´ë‹¹ URLë¡œ GET ìš”ì²­ (íƒ€ìž„ì•„ì›ƒ 10ì´ˆ)
   - User-Agent: "Mozilla/5.0 (compatible; WaitFree/1.0)"
4. ì‘ë‹µ ì‹œê°„ + ìƒíƒœ ì½”ë“œ + ì—ëŸ¬ ì—¬ë¶€ ê¸°ë¡
5. ping_resultsì— INSERT
6. ì—°ì† 5íšŒ ì´ìƒ 403/ì°¨ë‹¨ â†’ ping_enabled = false ì—…ë°ì´íŠ¸

**ì£¼ì˜:** ì´ APIëŠ” status APIì—ì„œ ë‚´ë¶€ì ìœ¼ë¡œ í˜¸ì¶œë¨. ì™¸ë¶€ ì§ì ‘ í˜¸ì¶œ ë°©ì§€ë¥¼ ìœ„í•´ ë‚´ë¶€ í•¨ìˆ˜ë¡œ êµ¬í˜„í•˜ëŠ” ê²ƒì„ ê¶Œìž¥.

---

## Supabase Realtime

**êµ¬ë… ëŒ€ìƒ:** reports í…Œì´ë¸” INSERT ì´ë²¤íŠ¸

**êµ¬ë… ë²”ìœ„:** í˜„ìž¬ ì‚¬ìš©ìžê°€ ë³´ê³  ìžˆëŠ” ê¸°ê´€ì˜ org_idë¡œ í•„í„°ë§
```
supabase
  .channel('reports')
  .on('postgres_changes', {
    event: 'INSERT',
    schema: 'public',
    table: 'reports',
    filter: `org_id=eq.${currentOrgId}`
  }, callback)
  .subscribe()
```

**íƒ­/ê¸°ê´€ ì „í™˜ ì‹œ:**
- ì´ì „ ê¸°ê´€ êµ¬ë… í•´ì œ â†’ ìƒˆ ê¸°ê´€ êµ¬ë… ì‹œìž‘

**ì—°ê²° ëŠê¹€ ì²˜ë¦¬:**
- Supabase í´ë¼ì´ì–¸íŠ¸ì˜ ìžë™ ìž¬ì—°ê²°ì— ì˜ì¡´
- ìž¬ì—°ê²° ì‹œ ìµœì‹  ë°ì´í„° í•œ ë²ˆ fetch (GET /api/status)ë¡œ ë™ê¸°í™”
- ì˜¤í”„ë¼ì¸ ìƒíƒœ ê°ì§€ ì‹œ "ì‹¤ì‹œê°„ ì—°ê²°ì´ ëŠê²¼ì–´ìš”. ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”" ë°°ë„ˆ í‘œì‹œ

---

## ë°ì´í„° ë³´ê´€/ì‚­ì œ ì •ì±…

- reports: 7ì¼ ê²½ê³¼ ì‹œ ì‚­ì œ
- ping_results: 7ì¼ ê²½ê³¼ ì‹œ ì‚­ì œ
- organizations: ì‚­ì œ ì•ˆ í•¨ (ì˜êµ¬ ë³´ê´€)
- ì‚­ì œ ë°©ë²•: Supabase SQL Editorì—ì„œ ìˆ˜ë™ ì‹¤í–‰í•˜ëŠ” SQL ì¿¼ë¦¬ ì œê³µ (MVPì—ì„œëŠ” ìžë™í™” ì•ˆ í•¨)

```sql
-- 7ì¼ ì§€ë‚œ ì œë³´ ì‚­ì œ
DELETE FROM reports WHERE created_at < NOW() - INTERVAL '7 days';
-- 7ì¼ ì§€ë‚œ í•‘ ê²°ê³¼ ì‚­ì œ
DELETE FROM ping_results WHERE created_at < NOW() - INTERVAL '7 days';
```

---

## ì‚¬ìš©ìž ì‹ë³„ ë°©ì‹ê³¼ í•œê³„

**ë°©ì‹:** @fingerprintjs/fingerprintjs ì˜¤í”ˆì†ŒìŠ¤ ë²„ì „ìœ¼ë¡œ ë¸Œë¼ìš°ì € í•‘ê±°í”„ë¦°íŠ¸ ìƒì„± â†’ ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ IPì™€ ê²°í•©í•˜ì—¬ SHA-256 í•´ì‹œ

**í•œê³„ì  (ê°ìˆ˜í•  ê²ƒ):**
- ê°™ì€ ì™€ì´íŒŒì´ì˜ ê°™ì€ ê¸°ê¸°/ë¸Œë¼ìš°ì € â†’ ê°™ì€ ì‚¬ëžŒìœ¼ë¡œ ì¸ì‹ (ì •ìƒ)
- VPN ì‚¬ìš© ì‹œ â†’ IP ë³€ê²½ìœ¼ë¡œ ë‹¤ë¥¸ ì‚¬ëžŒ ì·¨ê¸‰ (ì•…ìš© ê°€ëŠ¥í•˜ì§€ë§Œ MVPì—ì„œ ê°ìˆ˜)
- ì‹œí¬ë¦¿ ëª¨ë“œ â†’ í•‘ê±°í”„ë¦°íŠ¸ ë‹¬ë¼ì§ˆ ìˆ˜ ìžˆìŒ (ë‹¤ë¥¸ ì‚¬ëžŒ ì·¨ê¸‰, ê°ìˆ˜)
- ëª¨ë°”ì¼ LTE ì‚¬ìš©ìž â†’ ê°™ì€ ê¸°ì§€êµ­ IP ê³µìœ  ê°€ëŠ¥í•˜ì§€ë§Œ ë¸Œë¼ìš°ì € í•‘ê±°í”„ë¦°íŠ¸ë¡œ êµ¬ë¶„

---

## ìŠ¤íŒ¸/ì–´ë·°ì§• ë°©ì–´

- **ì œë³´ ìŠ¤íŒ¸:** ê°™ì€ fingerprint + ê°™ì€ ê¸°ê´€ â†’ 5ë¶„ì— 1íšŒ ì œí•œ
- **ê¸°ê´€ ë“±ë¡ ìŠ¤íŒ¸:** ê°™ì€ fingerprint â†’ 24ì‹œê°„ì— 3ê°œ ì œí•œ
- **ëŒ€ê¸° ì¸ì› ì–´ë·°ì§•:** 0~999 ë²”ìœ„ ê°•ì œ. ë¹„ì •ìƒ ê°’(999 ì—°ì†) ê°ì§€ëŠ” MVPì—ì„œ ì•ˆ í•¨

---

## ì—ëŸ¬/ì˜ˆì™¸ ì²˜ë¦¬ ì‹œë‚˜ë¦¬ì˜¤

1. **Supabase ì—°ê²° ì‹¤íŒ¨:** APIì—ì„œ 500 ë°˜í™˜ + í”„ë¡ íŠ¸ì—ì„œ "ì„œë²„ì— ë¬¸ì œê°€ ìƒê²¼ì–´ìš”. ìž ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”" í‘œì‹œ
2. **ping ëŒ€ìƒ ì‚¬ì´íŠ¸ DNS ì˜¤ë¥˜:** is_error = true ê¸°ë¡. ì—°ì† ì‹¤íŒ¨ ì¹´ìš´íŠ¸ì— í¬í•¨
3. **Realtime êµ¬ë… ì‹¤íŒ¨:** ìžë™ ìž¬ì—°ê²° ì‹œë„. ì‹¤íŒ¨ ì§€ì† ì‹œ ë°°ë„ˆ í‘œì‹œ + ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨ ìœ ë„
4. **ìž˜ëª»ëœ URLë¡œ ê¸°ê´€ ë“±ë¡:** URL í˜•ì‹ ê²€ì¦ ì‹¤íŒ¨ â†’ "ì˜¬ë°”ë¥¸ URLì„ ìž…ë ¥í•´ì£¼ì„¸ìš”" (ë“±ë¡ ë‹¨ê³„ì—ì„œ ì°¨ë‹¨)
5. **Supabase ë¬´ë£Œ ìš©ëŸ‰ ìž„ë°•:** 7ì¼ ì‚­ì œ ì •ì±…ìœ¼ë¡œ ê´€ë¦¬. 500MB ì´ˆê³¼ ê°ì§€ëŠ” MVPì—ì„œ ìˆ˜ë™ ëª¨ë‹ˆí„°ë§
6. **ë™ì‹œ ë‹¤ìˆ˜ ì œë³´ (í­ì£¼ ìƒí™©):** Supabaseê°€ ì²˜ë¦¬. í”„ë¡ íŠ¸ì—ì„œ 429 ìˆ˜ì‹  ì‹œ ë‚¨ì€ ì‹œê°„ í‘œì‹œ
7. **ë¸Œë¼ìš°ì € í•‘ê±°í”„ë¦°íŠ¸ ì‹¤íŒ¨:** ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—ëŸ¬ ì‹œ IPë§Œìœ¼ë¡œ í•´ì‹œ ìƒì„± (ì •í™•ë„ ë‚®ì•„ì§€ì§€ë§Œ ë™ìž‘ì€ í•¨)

---

## Vercel Cron ê´€ë ¨ (ë¬´ë£Œ í”Œëžœ ì „ëžµ)

Vercel ë¬´ë£Œ í”Œëžœì€ Cronì´ í•˜ë£¨ 1íšŒë§Œ ê°€ëŠ¥í•˜ë¯€ë¡œ, **Cron Jobì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ.**

ëŒ€ì‹  **On-Demand Ping** ë°©ì‹:
- ì‚¬ìš©ìžê°€ ìƒíƒœ ì¡°íšŒ ì‹œ ë§ˆì§€ë§‰ pingì´ 5ë¶„ ì´ìƒ ê²½ê³¼í–ˆìœ¼ë©´ ì„œë²„ì—ì„œ ping
- ì•„ë¬´ë„ ì•ˆ ë³´ë©´ pingë„ ì•ˆ í•¨ (ë¹„ìš© 0)
- ëˆ„êµ°ê°€ ë³´ê¸° ì‹œìž‘í•˜ë©´ ìžì—°ìŠ¤ëŸ½ê²Œ ping ì‹œìž‘

**Fallback:** ì•„ë¬´ë„ ë°©ë¬¸í•˜ì§€ ì•Šì•„ pingì´ ì˜¤ëž˜ëœ ê²½ìš° â†’ íšŒìƒ‰ ì‹ í˜¸ë“± + "ë§ˆì§€ë§‰ í™•ì¸: Nì‹œê°„ ì „"

---

## SEO

**ë©”íƒ€ íƒœê·¸:**
- title: "WaitFree - ì •ë¶€24 ì„œë²„ ìƒíƒœ | ê±´ê°•ë³´í—˜ê³µë‹¨ ëŒ€ê¸°ì‹œê°„ ì‹¤ì‹œê°„"
- description: "ê³µê³µê¸°ê´€ ì„œë²„ í„°ì¡Œë‚˜ìš”? ì „í™” ëŒ€ê¸° ëª‡ ëª…? ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•˜ì„¸ìš”"
- canonical: https://waitfree.vercel.app (ë°°í¬ í›„ í™•ì •)

**Open Graph:**
- og:title: "WaitFree - ê³µê³µê¸°ê´€ ì‹¤ì‹œê°„ ìƒíƒœ"
- og:description: "ì •ë¶€24 í„°ì¡Œë‚˜ìš”? ê±´ê°•ë³´í—˜ê³µë‹¨ ì „í™” ëŒ€ê¸° ëª‡ ëª…? ì§€ê¸ˆ í™•ì¸í•˜ì„¸ìš”"
- og:image: ì •ì  OG ì´ë¯¸ì§€ (ì‹ í˜¸ë“± 3ê°œ ì¼ëŸ¬ìŠ¤íŠ¸) â€” /public/og-image.png
- og:type: website

**ê¸°íƒ€:**
- robots.txt: ì „ì²´ í—ˆìš©
- sitemap.xml: MVPì—ì„œ ìˆ˜ë™ ìž‘ì„± (íŽ˜ì´ì§€ 2ê°œë¿)

---

## ë””ìžì¸ ë°©í–¥

- **ëª¨ë°”ì¼ ìš°ì„ :** max-width 640px ê¸°ì¤€ ë””ìžì¸ â†’ ë°ìŠ¤í¬íƒ‘ì€ ì¤‘ì•™ ì •ë ¬ max-width 480px ì»¨í…Œì´ë„ˆ
- **í°íŠ¸:** ì‹œìŠ¤í…œ ê¸°ë³¸ í°íŠ¸ (ì¶”ê°€ ë¡œë“œ ì—†ìŒ, ì†ë„ ìš°ì„ )
- **ìƒ‰ìƒ:**
  - ë°°ê²½: í°ìƒ‰ (#FFFFFF)
  - ì¹´ë“œ ë°°ê²½: ì—°í•œ íšŒìƒ‰ (#F9FAFB)
  - í…ìŠ¤íŠ¸: ê²€ì • (#111827)
  - ì´ˆë¡: #22C55E
  - ë…¸ëž‘: #EAB308
  - ë¹¨ê°•: #EF4444
  - íšŒìƒ‰ (ì •ë³´ì—†ìŒ): #9CA3AF
  - ë²„íŠ¼ ìž˜ ë¼ìš”: #DCFCE7 (ì´ˆë¡ ì—°í•œ)
  - ë²„íŠ¼ ì•ˆ ë¼ìš”: #FEE2E2 (ë¹¨ê°• ì—°í•œ)
- **ì‹ í˜¸ë“±:** ì›í˜•, ì§€ë¦„ 80px ì´ìƒ, ê·¸ë¦¼ìž íš¨ê³¼ (glow)ë¡œ ê°•ì¡°
- **ê¸€ìž ìµœì†Œí™”:** í•µì‹¬ ì •ë³´ë§Œ. ê¸´ ì„¤ëª… ì—†ìŒ
- **1ì´ˆ ì•ˆì— íŒŒì•…:** ì‹ í˜¸ë“± ìƒ‰ìƒë§Œ ë³´ë©´ ìƒíƒœ ì¸ì§€ ê°€ëŠ¥í•˜ë„ë¡
- **ë¼ì´íŠ¸ ëª¨ë“œë§Œ** (MVP)
